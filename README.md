
# Моделирование рассеяния волн и физически обоснованная нейросеть

## Описание проекта

Проект посвящён моделированию рассеяния электромагнитных волн на объемных объектах с помощью библиотеки **PyMeep**, а также разработке **физически обоснованной нейронной сети** на основе уравнений электродинамики.

Работа состоит из двух основных частей:
1. Моделирование методом конечных разностей во временной области (FDTD) с использованием PyMeep.
2. Построение и обучение нейросети, предсказывающей поля на основе распределения показателя преломления.

---

## Теоретическая основа

- Рассеяние Ми — моделирование взаимодействия плоской волны с диэлектрической сферой.
- Дифракция Френеля на щели — численная аппроксимация интегралов Френеля.
- Решение уравнений Максвелла с использованием FDTD-метода.

---

##  Используемые технологии

- **PyMeep** — Python-обёртка над Meep (FDTD-ядро на C++).
- **NumPy, SciPy** — обработка и анализ данных.
- **TensorFlow** — обучение физически обоснованной нейросети (U-Net).
- **HDF5 + ParaView** — визуализация симуляций.

---

## Пример кода (минимальная симуляция в PyMeep)

```python
import meep as mp

resolution = 50
cell = mp.Vector3(10, 10, 0)

geometry = [mp.Block(size=mp.Vector3(1, 1, mp.inf),
                     center=mp.Vector3(0, 0, 0),
                     material=mp.Medium(epsilon=12))]

source = [mp.Source(mp.ContinuousSource(frequency=1.0),
                    component=mp.Ez,
                    center=mp.Vector3(-4, 0, 0))]

sim = mp.Simulation(cell_size=cell,
                    geometry=geometry,
                    sources=source,
                    resolution=resolution)

sim.run(until=200)
```

---

## Физически обоснованная нейросеть

- **Вход:** 3D распределение показателя преломления `n(r)`
- **Выход:** Комплексное рассеянное поле `Us(r)`
- **Архитектура:** U-Net с 3D свёртками
- **Функция потерь:** остаток уравнения Гельмгольца в сетке:
  ```
  [∇² + k₀² n²(r)] Us(r) + k₀²(n²(r) - n₀²) Ui(r)
  ```

---

## Структура проекта
```
├── docs/                           # Документация по проекту
│   ├── presentation.pdf           # Презентация
│   └── Scattering and diffraction modeling... # Основной доклад по проекту

├── modeling/                      # Блок FDTD-моделирования (PyMeep)
│   ├── res/                       # Результаты численных симуляций
│   │   ├── Double_Slit_ap_...     # Дифракция на двойной щели
│   │   ├── Ellipse_ap_...         # Рассеяние на эллипсоидных объектах
│   │   ├── Grating_ap_...         # Дифракция на дифракционной решётке
│   │   ├── Single_Slit_ap_...     # Дифракция на одиночной щели
│   │   └── Sphere_ap_...          # Ми-рассеяние на сферических объектах
│   └── src/                       # Исходный код симулятора
│       ├── apertures.py           # Геометрии апертур (щели, решётки и т.п.)
│       ├── geometry.py            # Обобщённые функции построения геометрий
│       ├── lights.py              # Источники волн (тип, положение, частота)
│       ├── simulator_gui.py       # GUI интерфейс для запуска симуляций
│       └── visualization.py       # Построение полей, интенсивностей

├── neuron/                        # Блок физически обоснованной нейросети
│   ├── res/                       # Результаты работы нейросети
│   │   ├── r=8.png                # Прогноз рассеяния для радиуса 8
│   │   ├── r=12.png               # ...для радиуса 12
│   │   └── r=16.png               # ...для радиуса 16
│   └── src/                       # Исходный код нейросетевой части
│       ├── model.py               # Архитектура U-Net (3D-свёртки)
│       ├── physics.py             # Встроенные физические ограничения (уравнение Гельмгольца)
│       ├── train.py               # Скрипт обучения сети
│       ├── visualize.py           # Визуализация предсказаний сети
│       └── struct.JPG             # Изображение структуры среды/объекта

└── README.md                      # Описание проекта, инструкция по запуску

```
---

## Результаты

- Проведено моделирование дифракции и рассеяния на различных структурах.
- Получены карты интенсивности и распределения полей.
- Построена и протестирована нейросеть, удовлетворяющая уравнению Гельмгольца на обучении без разметки.

---

## Авторы

- Кривцов И.А.
- Смирнова М.А.
- Знаменский Н.Е.
  МФТИ, 2025 г.

---
